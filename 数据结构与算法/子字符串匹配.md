# 子字符串匹配

```python3
class KMP:

    def __init__(self, pattern):
        if len(pattern) == 0:
            raise Exception('the length of pattern is zero')
        self.length = len(pattern)
        self.pattern = pattern
        self.nextstat = [0] * self.length 
        self.nextstat[0] = -1
        index = 2
        prefix = 0
        while index < self.length:
            if pattern[index-1] == pattern[prefix]:
                prefix += 1
                self.nextstat[index] = prefix
                index += 1
            else:
                if prefix == 0:
                    self.nextstat[index] = 0
                    index += 1
                else:
                    prefix = self.nextstat[prefix]
        for i in range(1, self.length):
            if pattern[i] == pattern[self.nextstat[i]]:
                self.nextstat[i] = self.nextstat[self.nextstat[i]]
    
    def match(self, target):
        index = 0
        state = 0
        while index - state + self.length <= len(target):
            if target[index] == self.pattern[state]:
                state += 1
                if state == self.length:
                    return index - state + 1
                index += 1
            else:
                state = self.nextstat[state]
                if state == -1:
                    index += 1
                    state = 0
        return -1
```
